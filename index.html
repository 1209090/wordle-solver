<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Wordle Solver</title>
  <style>
    * { box-sizing: border-box; }
    body { font-family: system-ui, sans-serif; max-width: 600px; margin: 0 auto; padding: 1rem; }
    h1 { margin-top: 0; }
    .status { margin: 0.5rem 0; color: #666; }
    .guess-form { display: flex; gap: 0.5rem; margin: 1rem 0; }
    .guess-form input { flex: 1; padding: 0.5rem; font-size: 1rem; }
    .guess-form button { padding: 0.5rem 1rem; cursor: pointer; }
    .guesses { margin: 1rem 0; }
    .guess-row { display: flex; gap: 4px; margin-bottom: 4px; }
    .guess-cell { width: 48px; height: 48px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; border: 2px solid #ddd; }
    .guess-cell.correct { background: #6aaa64; color: #fff; border-color: #6aaa64; }
    .guess-cell.present { background: #c9b458; color: #fff; border-color: #c9b458; }
    .guess-cell.absent { background: #787c7e; color: #fff; border-color: #787c7e; }
    .filter-section { margin: 1.5rem 0; }
    .filter-section label { display: block; margin-bottom: 0.25rem; }
    .filter-section input { padding: 0.5rem; width: 100%; max-width: 300px; }
    .word-list { max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 0.5rem; margin-top: 0.5rem; font-family: monospace; }
    .word-list .count { color: #666; margin-bottom: 0.5rem; }
    .possible-words { margin-top: 1rem; }
    .error { color: #c00; }
  </style>
</head>
<body>
  <h1>Wordle Solver</h1>
  <p class="status" id="status">Загрузка слова дня…</p>

  <div class="guess-form">
    <input type="text" id="guessInput" maxlength="5" placeholder="Введите слово (5 букв)" autocomplete="off">
    <button type="button" id="submitGuess">Проверить</button>
  </div>

  <div class="guesses" id="guesses"></div>

  <div class="filter-section">
    <label for="lettersFilter">Слова, содержащие буквы (через запятую или подряд):</label>
    <input type="text" id="lettersFilter" placeholder="например: а,р,т или арт">
  </div>
  <div class="word-list" id="filteredList">
    <span class="count" id="filteredCount"></span>
    <div id="filteredWords"></div>
  </div>
  <script>
/**
 * Gets the current word from the API.
 * 
 * @returns {Promise<string>} The current word.
 */
async function getCurrentWord() {
  return fetch('https://wordle.belousov.one/api/v2/daily/?lang=ru')
          .then(res => res.json())
          .then(res => res.data.word);
}
/**
 * Encodes a word and its match results into a conditions object.
 * 
 * @param {string} target - The word that was guessed.
 * @param {string} matches - The match result string (e.g., "+-=-+").
 *   '+' : Correct letter, correct position.
 *   '=' : Correct letter, wrong position.
 *   '-' : Letter not in word (or exceeds count).
 * @returns {Object} A conditions object describing the constraints.
 */
function encode(target, matches) {
  const chars = {};
  const targetChars = target.split('');
  
  const charCounts = {};
  for (const ch of targetChars) {
    charCounts[ch] = (charCounts[ch] || 0) + 1;
  }

  for (let i = 0; i < targetChars.length; i++) {
    const ch = targetChars[i];
    if (Object.prototype.hasOwnProperty.call(chars, ch)) continue;

    const count = charCounts[ch];
    if (count === 1) {
      switch (matches[i]) {
        case '-':
          chars[ch] = { count: { eq: 0 } };
          break;
        case '+':
          chars[ch] = { in: [i], count: { gt: 0 } };
          break;
        case '=':
          chars[ch] = { count: { gt: 0 }, not_in: [i] };
          break;
      }
      continue;
    }

    const indices = [];
    for (let idx = 0; idx < targetChars.length; idx++) {
      if (targetChars[idx] === ch) indices.push(idx);
    }

    const vals = indices.map(idx => matches[idx]);
    const nums = {};
    for (const v of vals) {
      nums[v] = (nums[v] || 0) + 1;
    }

    if ((nums['='] || 0) === 0 && (nums['-'] || 0) > 0) {
      if ((nums['+'] || 0) === 0) {
        chars[ch] = { count: { eq: 0 } };
      } else {
        chars[ch] = { eq: indices.filter(idx => matches[idx] === '+') };
      }
    } else {
      let countHash;
      if ((nums['-'] || 0) > 0) {
        countHash = { eq: vals.length - nums['-'] };
      } else {
        countHash = { gt: vals.length - 1 };
      }

      const res = { count: countHash };
      const plusIndices = indices.filter(idx => matches[idx] === '+');
      if ((nums['+'] || 0) > 0) {
        res.in = plusIndices;
      }

      const notInIndices = indices.filter(idx => matches[idx] === '-' || matches[idx] === '=');
      if (notInIndices.length > 0) {
        res.not_in = notInIndices;
      }
      chars[ch] = res;
    }
  }
  return chars;
}

/**
 * Generates a match result string for a guess against a target word.
 * 
 * @param {string} target - The target (secret) word.
 * @param {string} guess - The guessed word.
 * @returns {string} The match result string (e.g., "+-=-+").
 */
function matches(target, guess) {
  const chars = {};
  for (const ch of target.split('')) {
    chars[ch] = (chars[ch] || 0) + 1;
  }

  for (let i = 0; i < 5; i++) {
    const ch = guess[i];
    if (target[i] === ch) {
      chars[ch]--;
    }
  }

  const res = [];
  for (let i = 0; i < 5; i++) {
    const ch = guess[i];
    if (target[i] === ch) {
      res.push('+');
    } else if (target.includes(ch) && chars[ch] > 0) {
      chars[ch]--;
      res.push('=');
    } else {
      res.push('-');
    }
  }
  return res.join('');
}

/**
 * Checks if a word satisfies a set of conditions.
 * 
 * @param {string} word - The word to check.
 * @param {Object} conditions - The conditions object (from encode).
 * @returns {boolean} True if the word matches all conditions.
 */
function matches_q(word, conditions) {
  const wordChars = word.split('');
  const charCounts = {};
  for (const ch of wordChars) {
    charCounts[ch] = (charCounts[ch] || 0) + 1;
  }

  for (const [ch, conds] of Object.entries(conditions)) {
    if (conds.count && conds.count.eq === 0) {
      if (Object.prototype.hasOwnProperty.call(charCounts, ch)) return false;
      continue;
    }

    const chCount = charCounts[ch] || 0;

    if (conds.count) {
      const count = conds.count;
      if (count.eq !== undefined) {
        if (chCount !== count.eq) return false;
      } else if (count.gt !== undefined) {
        if (chCount <= count.gt) return false;
      }
    }

    if (conds.eq) {
      if (conds.eq.some(i => wordChars[i] !== ch) || chCount !== conds.eq.length) return false;
    }

    if (conds.in) {
      if (conds.in.some(i => wordChars[i] !== ch)) return false;
    }

    if (conds.not_in) {
      if (conds.not_in.some(i => wordChars[i] === ch)) return false;
    }
  }
  return true;
}


    const WORDS = ["аббат","абзац","аборт","абрек","абрис","абхаз","аванс","авеню","аверс","авизо","авось","аврал","автор","агава","агент","агнец","агора","агути","адепт","адрес","азарт","азиат","айран","акрил","аксон","актер","актив","акула","акциз","акция","алиби","алкаш","аллах","аллея","аллюр","алмаз","алтын","алыча","альфа","амбал","амбар","амбре","амеба","аминь","ампер","ампир","ангар","ангел","аниме","анкер","анонс","анфас","анчар","аорта","арбуз","аргон","ареал","арена","арест","ариец","аркан","армия","армяк","архар","архат","архей","архив","аршин","асана","аскет","аспид","астма","астра","атака","атлас","атлет","атман","атолл","аудио","аудит","афера","афиша","ахилл","ацтек","бабка","багаж","багет","багор","бадья","базар","базис","байка","бакен","бакша","балда","балет","балка","балык","банан","банда","банка","барак","баран","баржа","барий","барин","барон","барыш","басня","батат","батог","батон","батут","батыр","бахча","бачок","башка","башня","бегун","бедро","бекас","бекон","белка","белок","белье","беляш","берег","берет","бетон","бибут","бигос","бигус","бидон","бизон","билет","бинго","бином","биота","биржа","бирка","бирюк","бисер","битва","битум","битье","битюг","благо","блажь","бланк","блеск","блоха","блуза","блюдо","бобер","богач","бодун","бойня","бокал","болид","бомба","бонза","бонус","бордо","борец","боров","босяк","ботва","бочка","бочок","браво","брага","брань","брасс","брейк","бремя","бренд","брешь","бридж","бровь","бронь","броня","брошь","брюки","брюхо","бубен","бубна","бугай","бугор","будда","будка","будни","буква","букет","булат","булка","булла","бульк","буран","бурка","бурун","бурят","бутан","бутен","бутик","бутон","бутса","бутуз","буфер","буфет","бухта","быдло","бытие","бычок","бювет","вагон","вазон","вакса","валет","валик","валун","вальс","ванна","варан","варка","варяг","ватин","вафля","вахта","вброс","вдова","веган","ведро","велюр","венгр","венец","веник","венок","вепрь","верба","верфь","весло","весна","весть","ветвь","ветер","ветка","вечер","взвар","взвод","вздор","вздох","взлет","взлом","взмах","взмет","взмыв","взнос","взрез","взрыв","видео","визир","визит","вилка","вилла","вилок","винил","винир","виола","вираж","вирус","виски","висок","виток","вихор","вихры","вихрь","вишня","вклад","влага","вобла","водка","вожак","вождь","вожжа","возжа","возня","война","вокал","волан","волна","волок","волос","волох","волхв","вопль","ворон","ворот","ворох","ворье","вотум","вояка","впрок","впуск","враки","время","встык","всход","вуаль","вчера","въезд","выбег","выбор","вывес","вывих","вывод","вывоз","выгиб","выгон","выгул","выдох","выдра","выдув","выезд","выжиг","выжим","вызов","выкат","выкос","выкуп","выкус","вылаз","вылет","вылов","вынос","выпад","выпас","выпек","выпот","вырез","выруб","высев","вытье","выход","вычет","вышка","вьюга","вязка","газон","гайка","галка","галоп","галун","гамак","гамма","ганец","гараж","гарда","гарем","гауда","гаучо","гашиш","гвалт","гейша","гелий","гений","геном","геоид","герой","гетра","гетто","гжель","гидра","гиена","гинея","гичка","глава","гладь","глина","глист","глубь","глушь","глыба","глыбь","глясе","гнида","гниль","гобой","говор","гогот","голем","голод","голос","гольф","голяк","гомон","гонец","гонзо","гонка","гонор","гопак","горец","горка","горло","город","горох","гость","гофра","грамм","гранд","грант","грань","графа","греза","грива","гриль","грипп","гроза","гросс","груда","грудь","грунт","груша","грыжа","гряда","грязь","гуашь","губка","гудеж","гудок","гуляш","гумус","гусак","гусар","гусли","гюрза","давка","дамба","дамка","дацан","дверь","дебет","дебил","дебош","дебри","дебют","девиз","девка","деизм","декан","декор","дележ","делец","демон","денди","дерби","десна","детка","дефис","джига","джинн","дзюдо","диван","диета","дилер","динар","дичка","длань","длина","добор","добро","довод","довоз","догма","додзе","дождь","дожим","дозор","докер","долма","домен","домик","домна","домра","донка","донна","донор","донос","доска","досуг","досыл","досье","доход","дочка","драже","драка","драма","древо","дрейф","дрель","дрема","дрифт","дробь","дрова","дрожь","дрозд","дрофа","друза","друид","дрянь","дубль","дубок","дудка","дужка","дукат","дупло","дурак","дутье","душка","душок","дуэль","дылда","дымка","дымок","дырка","дышло","дюшес","дятел","евнух","еврей","егерь","егоза","ездок","ересь","есаул","жажда","жакет","жарка","жатва","жвало","желоб","желчь","жених","жердь","жерло","жесть","жетон","живец","живот","жизнь","жилет","жилец","жилка","жилье","жираф","жирок","жокей","жрица","жулик","жулье","жупел","забег","забой","забор","завал","завес","завет","завод","завоз","завуч","загар","загон","загул","задел","задир","задор","заезд","зажим","зазор","заика","заказ","закал","закат","закон","закоп","закос","закуп","залет","залив","залог","залом","замах","замер","замес","замок","замуж","замша","занос","запад","запал","запас","запах","запев","запил","запой","запор","зарин","зарок","заряд","засев","засов","засол","засор","засос","затея","затон","затор","затык","заход","зацеп","зачет","зачин","звено","зверь","зебра","зевок","зелье","земля","зенит","зерно","зефир","зипун","злато","злоба","знамя","знать","зомби","зубец","зудеж","зумба","зятек","иблис","иваси","иврит","игнор","игрек","игрок","идеал","идиот","извет","извив","извоз","изгиб","изгой","излет","излом","измор","износ","изъян","изыск","икона","икота","имаго","имидж","ингуш","индус","индюк","инжир","интим","иприт","ископ","искра","искус","ислам","испуг","истец","исток","исход","иудей","ифрит","ишиас","йомен","кабак","кабан","кавер","каган","кагор","кадет","кадка","кадры","кадык","казак","казан","казах","казна","казнь","казус","кайма","кайра","какао","калач","калий","калым","камео","камея","камин","камус","камыш","канал","канат","канва","канон","каноэ","канун","канюк","капер","капля","капор","капот","каппа","капут","карат","карга","карго","карма","карри","карст","карта","каска","каско","касса","каста","катер","катет","катод","каток","кауза","кацап","качка","качок","кашне","кашпо","каюта","квант","кварк","кварц","квест","квота","кебаб","кегль","кегля","кельт","келья","кепка","кетон","кефир","кешью","кивок","кизил","кизяк","кильт","кимчи","кинза","киноа","киоск","кипеж","кипиш","кирза","кирка","кирха","кисет","кисея","киста","кисть","кишка","кишки","кладь","класс","клерк","клест","клеть","клещи","клика","клинч","клипс","клише","клоун","клуша","клюка","кляча","книга","князь","коала","кобра","ковер","ковка","кодек","кодла","кожух","козел","койка","койот","кокни","кокон","кокос","колба","колея","колли","колоб","колок","колос","колун","колье","кольт","комар","комби","комбо","комик","комод","комок","конга","конец","конка","конус","конюх","копер","копир","копия","копка","копна","копра","коран","корка","корма","короб","косма","космы","кость","косяк","котел","кофта","кочан","кочка","кошка","кощей","крага","кража","краля","краса","кредо","креол","крест","кровь","кроль","крона","кросс","кроха","круиз","крупа","круча","крыло","крыса","крыша","ксива","кубик","кубок","кудри","кузен","кузов","кукан","кукиш","кукла","куксу","кулак","кулек","кулер","кулик","кулич","кулон","культ","кумир","кумыс","кунфу","купаж","купец","купол","купон","кураж","курес","курок","курур","кусок","кутеж","кутья","кухня","кучер","кучка","кушак","кхмер","кювет","кюрий","кюфта","лабаз","лаваш","лавка","лавра","ладан","ладья","лазер","лакей","лампа","лапта","лапша","ларек","ларец","ласка","лассо","ласта","латте","латук","латыш","левша","лежак","лежка","лейка","лемма","лемур","лента","лепет","лепка","лепра","лепта","леска","лесть","леток","летун","леший","лиана","ливер","лидар","лидер","ликер","лилея","лилия","лиман","лимит","лимон","лимфа","линза","линия","липид","лирик","литий","литье","лихач","лихва","лицей","лишай","лобби","лобио","ловец","ловля","логик","лодка","ложка","локон","локус","ломка","лопух","лоток","лотос","лохмы","лошак","лубок","лужок","лузга","лунка","лыжня","лычка","люмен","лютик","лютня","ляжка","лямка","магия","магма","мадам","маета","мажор","мазня","мазок","мазут","майка","майор","макет","малек","малыш","маляр","мамба","мамка","манго","мангр","манеж","манер","мания","манка","манок","манто","манту","манул","маори","марал","марго","маржа","марка","марля","маска","масло","масон","масса","масть","матка","мафия","мацун","мачта","медиа","медик","медок","медяк","мерин","мерка","месса","место","месть","месяц","метан","метис","метка","метла","метод","метро","мечта","мешок","миазм","мизер","минер","минор","минус","мираж","мирра","миска","митра","модем","модус","мойва","мойка","мокко","молва","молот","молох","моляр","монах","мопед","морда","мороз","морок","моряк","мотив","мотня","моток","мотор","мочка","мошка","мошна","мразь","мудак","мужик","музей","мулат","мулла","муляж","мумие","мумия","мусор","муфта","мушка","мымра","мысль","мытье","мышка","мышца","мэрия","мюсли","мякиш","мямля","мясцо","мятеж","набат","набег","набоб","набор","навал","навар","навес","навет","навоз","навык","наган","нагар","нагиб","надел","надир","наезд","нажим","наказ","накал","накат","налет","налив","налим","налог","намаз","намек","намыв","напев","напой","напор","нарды","народ","нарты","нарыв","наряд","насос","насып","натяг","наука","нахал","нация","начес","начос","наяда","невод","недра","недуг","немец","немой","нерка","нерпа","несун","нефть","нимфа","нитка","ничья","нищий","ножка","ножны","номад","номер","норка","норма","норов","носач","носик","носки","носок","ношпа","нубук","нужда","нутро","нырок","нытик","нытье","нюанс","оазис","обвал","обвес","обвод","обвоз","обгон","обдел","обдув","обжиг","обжим","обзор","обида","облет","облив","облик","облом","обман","обмен","обмер","обмыв","обнос","образ","обрат","обрез","оброк","обруб","обруч","обрыв","обряд","обсев","обувь","обуза","обход","обчет","объем","обыск","овоид","овраг","овчар","огонь","огрех","одурь","озеро","озноб","океан","окись","оклад","оклик","оковы","окрас","окрик","округ","оксид","октет","окунь","олень","олеум","олива","олимп","олифа","олово","ольха","омега","омела","омлет","омуль","онагр","опала","опара","опека","опера","опиат","опись","опиум","оплот","оплыв","опора","опрос","оптик","опция","орава","орган","оргия","орден","ордер","ореол","орлан","орляк","ортез","осада","осень","осетр","осина","оскал","осмий","осмос","особа","особь","осоед","осока","остов","остяк","осыпь","отара","отбой","отбор","отвар","отвес","ответ","отвод","отвоз","отгул","отдел","отдых","отель","отжиг","отжим","отзыв","отказ","откат","откол","откос","откуп","отлет","отлив","отлов","отлом","отмер","отпад","отпор","отрез","отрог","отрок","отруб","отрыв","отряд","отсек","отсос","отсыл","отсып","отток","отход","отцеп","отчет","отчим","отшиб","отщеп","офсет","офшор","охват","охота","очерк","ощупь","падеж","падла","пакет","пакля","палас","палач","палец","палка","пампа","панда","панно","панье","папка","парад","парез","парик","парка","паром","парта","парус","парча","пасик","паста","пасть","пасха","пасюк","патио","пауза","пафос","пахта","пацан","пачка","пашня","пашот","певец","певун","пегас","пейот","пекан","пекло","пемза","пенал","пение","пенис","пенка","пенне","пенни","пепел","пепси","перец","перст","песец","песня","песок","петля","петух","печка","пешка","пиала","пиано","пижма","пижон","пикап","пикет","пилка","пилон","пилот","пинок","пинта","пират","пирог","питон","питье","пихта","пицца","пламя","пласт","плата","плато","плаха","плебс","плева","плеер","племя","плеск","плеть","плечо","плешь","плита","плоть","плюха","побег","побор","повар","повод","погон","подол","поезд","пожар","позер","позор","позыв","поиск","пойка","пойло","пойма","показ","покер","покой","покол","покос","полба","полет","полив","полип","полис","полка","полог","полоз","полюс","поляк","поляр","помет","помин","помол","помпа","понос","пончо","попса","порез","порей","порка","порно","порог","порок","порох","порча","порыв","посад","посев","посол","посох","посыл","поташ","потек","поток","потоп","поход","почва","почет","почин","почка","почта","пошиб","пошив","поэма","право","прайд","прайс","прана","праща","пресс","прием","прима","принт","принц","прион","приют","проба","проем","проза","прыть","прядь","пряжа","псина","птаха","птица","пугач","пудра","пульс","пульт","пункт","пупок","пурга","пусто","пучок","пушка","пушту","пчела","пшено","пыжик","пырей","пытка","пышка","пьеза","пьеса","пятак","пятка","пятно","пяток","радар","раджа","радий","радио","радон","разум","район","ракия","ралли","рамка","рампа","ранец","ранка","ранчо","раунд","рахит","рацио","рация","рвань","рвота","ребро","ребус","регби","регги","редис","редут","режим","резак","резец","резка","резня","резон","резус","рейка","рельс","рента","репей","репер","репка","ретро","речка","решка","рибай","рикша","ринит","риска","рифма","робот","ровня","рогоз","родео","родич","родня","рожок","розга","рознь","рокер","рокот","ролик","роман","рондо","ронин","ропот","ротор","рохля","рояль","ртуть","рубеж","рубец","рубин","рубка","рубль","ружье","руина","рукав","рулет","рулон","румба","румын","рупия","рупор","русак","русин","русич","русло","ручей","ручка","рыбак","рывок","рыжик","рынок","рысак","рысца","рытье","рычаг","рюмка","рябок","ряска","сабля","саван","садик","садка","сазан","сайга","сайра","сакля","салат","салки","салон","салют","самба","самбо","самец","самка","самса","санки","сапер","сапог","сапун","сарай","сатин","сатир","сауна","сахар","сачок","сброд","сброс","сбруя","свара","сваха","свекр","свеча","свинг","свист","свита","свора","свояк","связь","сглаз","сдача","сдвиг","сдоба","сеанс","север","седан","седло","сезон","секта","селфи","семга","семит","семья","сенат","сепия","серия","сетка","сечка","сигма","силач","силок","силос","синод","синус","синяк","сипай","сироп","ситец","ситро","сифон","скала","скарб","скаут","скачь","сквер","скейт","скетч","скирд","склад","склеп","склон","скоба","скотч","скраб","скрип","скука","скула","скунс","слава","слайд","слеза","сленг","слива","слизь","слинг","слово","слуга","слюда","слюна","слюни","смена","смерд","смерч","смесь","смета","смола","смотр","смрад","смузи","смута","смуть","смысл","снедь","сноха","собес","собор","совет","совок","созыв","сойка","сокет","сокол","солод","сонар","сонет","сопка","сопло","сопля","сорго","сосед","соска","сосна","сосок","сосуд","сотня","софит","спазм","спесь","спина","спирт","спица","сплав","сплин","сплит","спора","спорт","спред","спрей","спрос","спрут","спурт","спуск","срань","среда","ссора","ссуда","стадо","сталь","старт","стать","ствол","створ","стезя","стейк","стела","стена","стенд","степь","стиль","стихи","стоик","столб","столп","стопа","стояк","страж","страх","стриж","строй","строп","струг","струя","стужа","ступа","судак","судно","судок","судья","суета","сукно","сумах","сумка","сумма","сурок","сусло","сутки","сутра","суфле","сушка","сущее","сфера","схема","схима","сцена","счеты","съезд","сынок","сырец","сырок","сырье","сычуг","сыщик","сюжет","сюита","табак","табло","табор","табун","тазик","тайга","тайна","такса","такси","талер","талиб","талия","талон","тальк","танго","танец","танин","тапер","тапир","тапок","таран","тариф","тахта","тачка","тварь","тверк","твист","театр","тезис","тезка","теизм","текст","телец","телка","телок","тембр","тенге","тенор","тепло","терем","терка","тесак","тесто","тесть","тетка","техно","течка","типаж","типун","тираж","тиран","тиски","титан","титул","ткань","товар","токен","толпа","толща","томат","тонер","тоник","тонна","тонус","топаз","топик","топка","топор","топот","торба","торги","торец","торос","тоска","тотал","тотем","точка","трава","тракт","транс","транш","траст","трата","траур","трель","тренд","треск","трест","треух","трефа","трико","триод","тромб","тропа","троян","труба","трусы","труха","трюмо","тубус","тукан","тулуп","тулья","тумак","туман","тумба","тунец","тупик","турка","турне","турок","тутти","туфля","туфта","тучка","тщета","тыква","тычок","тюбик","тюрок","тюфяк","тягач","тягло","тягун","тяжба","тяпка","убыль","углич","уголь","угорь","удаль","удача","удила","удило","узбек","уздцы","узник","уклад","уклон","укроп","уксус","улика","улица","умами","умище","умник","умора","унами","унтер","унция","упрек","упырь","успех","устав","устой","уступ","устье","утеря","утеха","утиль","ухарь","ухват","учеба","учхоз","ущерб","фагот","фазан","факел","факир","фалда","фанат","фарад","фарси","фасад","фасет","фасон","фатом","фатум","фауна","фаянс","фенол","ферзь","ферма","феска","фетиш","фиакр","фиала","физик","фикса","фикус","филей","филин","фильм","фимоз","финал","финик","финиш","фиорд","фирма","фишка","фланг","флирт","флора","флюид","фляга","фобия","фокус","фондю","форма","форум","фотон","фраза","франк","франт","фрахт","фреза","френч","фронт","фрукт","фугас","фужер","фураж","фурия","фурор","фьорд","фюрер","хайку","хакер","халат","халва","хамло","хамон","ханжа","харам","харчо","хвала","хворь","хвост","херес","химик","химия","хинди","хинин","хиппи","хитин","хлест","хлыст","хмель","хмурь","хобби","хобот","ходка","ходок","ходун","хокку","холка","холод","холоп","холст","холуй","хомут","хомяк","хорал","хорда","хорей","хорек","хохма","хохот","хруст","хумус","хунну","хунта","хурма","хутор","хычин","цапля","цацка","цевье","цедра","цезий","центр","цигун","цимес","цинга","циник","цифра","цокот","цукат","цыган","цынга","чабан","чадра","чайка","чакра","чалма","чарка","часик","часть","чашка","чекан","челка","чепец","черва","червь","черед","череп","чернь","черта","ческа","честь","четки","чехлы","чехол","чечен","чешка","чешуя","чибис","чижик","чипсы","чирей","число","чопик","чрево","чтиво","чубук","чуваш","чугун","чудак","чужак","чукча","чулан","чулок","чурка","чутье","шабаш","шавка","шайба","шакал","шалаш","шалун","шаман","шапка","шарик","шасси","шатен","шатер","шатун","шафер","шахта","шашка","шашки","шашни","шваль","шейка","шельф","шепот","шериф","шинок","ширма","шитье","шифер","шифон","шихан","шишка","шкала","шкант","шквал","шкода","школа","шкура","шланг","шлейф","шляпа","шмель","шнапс","шобла","шокер","шорох","шорты","шоссе","шофер","шпага","шпала","шпана","шпиль","шпион","шпора","шприц","шпрот","шрифт","штамм","штамп","штаны","штиль","штифт","штора","шторм","штраф","штрек","штрих","штука","штурм","штырь","шубка","шулер","шумер","шумок","шурин","шурпа","шуруп","шутка","шхуна","щебет","щегол","щелка","щенок","щепка","щетка","щипок","щипцы","щиток","эгида","эклер","экран","элита","эмаль","эпоха","эрзац","эркер","эскиз","эстет","этика","этнос","эфиоп","юниор","юнкер","юнкор","юннат","юноша","юрист","ябеда","ягель","ягода","ягуар","якорь","ямщик","ярлык","ясень","яство","яхонт"];

    let secretWord = null;
    const guesses = [];

    const statusEl = document.getElementById('status');
    const guessInput = document.getElementById('guessInput');
    const submitBtn = document.getElementById('submitGuess');
    const guessesEl = document.getElementById('guesses');
    const lettersFilter = document.getElementById('lettersFilter');
    const filteredCount = document.getElementById('filteredCount');
    const filteredWords = document.getElementById('filteredWords');
    const possibleCount = document.getElementById('possibleCount');
    const possibleWords = document.getElementById('possibleWords');

    async function loadSecret() {
      try {
        secretWord = await getCurrentWord();
        statusEl.textContent = 'Слово дня загружено. Вводите догадки.';
        statusEl.classList.remove('error');
      } catch (e) {
        statusEl.textContent = 'Ошибка загрузки слова: ' + e.message;
        statusEl.classList.add('error');
      }
    }

    function renderGuesses() {
      guessesEl.innerHTML = guesses.map(({ guess, matchString }) => {
        const row = document.createElement('div');
        row.className = 'guess-row';
        for (let i = 0; i < 5; i++) {
          const cell = document.createElement('div');
          cell.className = 'guess-cell';
          const c = matchString[i];
          if (c === '+') cell.classList.add('correct');
          else if (c === '=') cell.classList.add('present');
          else cell.classList.add('absent');
          cell.textContent = guess[i] || '';
          row.appendChild(cell);
        }
        return row.outerHTML;
      }).join('');
    }

    function getFilterLetters() {
      const raw = (lettersFilter.value || '').replace(/[,\s]+/g, '').toLowerCase();
      return raw ? raw.split('') : [];
    }

    function filterByLetters(words, letters) {
      if (letters.length === 0) return words;
      return words.filter(word => letters.every(ch => word.includes(ch)));
    }

    function getPossibleWords() {
      if (guesses.length === 0) return WORDS;
      return WORDS.filter(word => {
        return guesses.every(({ guess, matchString }) => matches_q(word, encode(guess, matchString)));
      });
    }

    function updateFilteredList() {
      const letters = getFilterLetters();
      const possible = getPossibleWords();
      const list = letters.length ? possible.filter(w => letters.every(ch => w.includes(ch))) : possible;
      filteredCount.textContent = list.length + ' слов';
      filteredWords.textContent = list.slice(0, 200).join(', ');
      if (list.length > 200) filteredWords.textContent += '…';
    }

    function updatePossibleList() {
      const list = getPossibleWords();
      possibleCount.textContent = list.length + ' возможных слов';
      possibleWords.textContent = list.slice(0, 200).join(', ');
      if (list.length > 200) possibleWords.textContent += '…';
    }

    function applyFilters() {
      const letters = getFilterLetters();
      const possible = getPossibleWords();
      const list = letters.length ? possible.filter(w => letters.every(ch => w.includes(ch))) : possible;
      filteredCount.textContent = list.length + ' слов';
      filteredWords.textContent = list.slice(0, 200).join(', ');
      if (list.length > 200) filteredWords.textContent += '…';

      possibleCount.textContent = possible.length + ' возможных слов';
      possibleWords.textContent = possible.slice(0, 200).join(', ');
      if (possible.length > 200) possibleWords.textContent += '…';
    }

    submitBtn.addEventListener('click', () => {
      if (!secretWord) return;
      const guess = (guessInput.value || '').trim().toLowerCase();
      if (guess.length !== 5) {
        statusEl.textContent = 'Введите 5 букв.';
        return;
      }
      if (!WORDS.includes(guess)) {
        statusEl.textContent = 'Слово не из списка.';
        return;
      }
      const matchString = matches(secretWord, guess);
      guesses.push({ guess, matchString });
      guessInput.value = '';
      renderGuesses();
      applyFilters();
      statusEl.textContent = 'Слово дня загружено. Вводите догадки.';
    });

    lettersFilter.addEventListener('input', applyFilters);

    loadSecret().then(() => {
      applyFilters();
    });
  </script>
</body>
</html>
